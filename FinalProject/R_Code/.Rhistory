getwd()
getwd()
knitr::opts_chunk$set(echo = TRUE)
setwd("C:/Users/scyth/OneDrive/Documents/HarrisburgU/AN_506_OS/EDA/FinalProject/R_Code")
gm_raw <- read.csv("C:/Users/scyth/OneDrive/Documents/HarrisburgU/AN_506_OS/EDA/FinalProject/Data/gapminder.csv")
gm_nona <- gm_raw
??fill()
library(reshape)
library(reshape2)
??fill()
library(tidyr)
library(tidyr)
View(gm_nona)
fill(gm_nona,population)
View(gm_raw)
View(gm_nona)
gm_nona <- fill(gm_nona,population)
View(gm_nona)
gm_nona <- gm_raw
gm_nona <- gm_raw %>% fill(population)
rm(gm_nona)
str(gm_raw)
#Fixing Data Type
gm_datatype <- gm_raw
gm_datatype$population <- as.integer(gm_raw$population)
View(gm_datatype)
View(gm_raw)
#Fixing Data Type
gm_datatype <- gm_raw
gm_datatype$population <- as.numeric(gm_raw$population)
View(gm_datatype)
?read.csv
?read_csv
??read_csv
library(readr)
?read_csv
View(gm_raw)
str(gm_raw)
gm_raw <- read_csv("C:/Users/scyth/OneDrive/Documents/HarrisburgU/AN_506_OS/EDA/FinalProject/Data/gapminder.csv", col_types = "finif")
str(gm_raw)
View(gm_raw)
str(gm_raw)
gm_raw1 <- read_csv("C:/Users/scyth/OneDrive/Documents/HarrisburgU/AN_506_OS/EDA/FinalProject/Data/gapminder.csv")
str(gm_raw1)
gm_raw1$Country <- as.factor(gm_raw1$Country)
str(gm_raw1)
gm_raw <- read_csv("C:/Users/scyth/OneDrive/Documents/HarrisburgU/AN_506_OS/EDA/FinalProject/Data/gapminder.csv", col_types = "finif")
gm_raw <- read_csv("C:/Users/scyth/OneDrive/Documents/HarrisburgU/AN_506_OS/EDA/FinalProject/Data/gapminder.csv", col_types = "finif")
str(gm_raw)
gm_raw <- read_csv("C:/Users/scyth/OneDrive/Documents/HarrisburgU/AN_506_OS/EDA/FinalProject/Data/gapminder.csv", col_types = "finif")
View(gm_raw)
gm_raw$Country <- as.factor(gm_raw$Country)
str(gm_raw)
View(gm_raw)
#Filling NA's
gm_datatype <- gm_raw
setwd("C:/Users/scyth/OneDrive/Documents/HarrisburgU/AN_506_OS/EDA/FinalProject/R_Code")
library(tidyr)
library(readr)
gm_raw <- read_csv("C:/Users/scyth/OneDrive/Documents/HarrisburgU/AN_506_OS/EDA/FinalProject/Data/gapminder.csv", col_types = "finif")
View(gm_raw)
#Filling NA's
gm_nona <- gm_raw
gm_nona <- gm_raw %>% fill(population)
View(gm_nona)
table(gm_nona)
table(gm_nona$income)
summary(gm_nona)
gm_nona[is.na(income)]
#Filling NA's
gm_nona <- gm_raw
gm_nona <- gm_raw %>% fill(population)
gm_nona[is.na(income)]
gm_nona[is.na(gm_nona$income)]
is.na(gm_nona$income)
gm_nona[is.na(gm_nona$income),]
gm_nona[is.na(gm_nona$income),1]
gm_nona[is.na(gm_nona$income),1] %>% unique()
knitr::opts_chunk$set(echo = TRUE)
str(gm_raw)
View(gm_raw)
gm_raw <- read_csv("C:/Users/scyth/OneDrive/Documents/HarrisburgU/AN_506_OS/EDA/FinalProject/Data/gapminder.csv", col_types = "ffniif")
setwd("C:/Users/scyth/OneDrive/Documents/HarrisburgU/AN_506_OS/EDA/FinalProject/R_Code")
library(tidyr)
library(readr)
gm_raw <- read_csv("C:/Users/scyth/OneDrive/Documents/HarrisburgU/AN_506_OS/EDA/FinalProject/Data/gapminder.csv", col_types = "ffniif")
str(gm_raw)
#Filling NA's
gm_nona <- gm_raw
gm_nona <- gm_raw %>% fill(population)
#There are some NA values in income.
summary(gm_nona$income)
library(mice)
#Filling NA's
gm_nona <- gm_raw
gm_nona <- gm_raw %>% fill(population)
#There are some NA values in income.
install.packages("VIM")
library(VIM)
aggr_plot <- aggr(gm_raw, col=c('navyblue','red'), numbers=TRUE, sortVars=TRUE, labels=names(gm_raw), cex.axis=.7, gap=3, ylab=c("Histogram of missing data","Pattern"))
gm_nona <- gm_raw %>% fill(population)
aggr_plot_1 <- aggr(gm_nona, col=c('navyblue','red'), numbers=TRUE, sortVars=TRUE, labels=names(gm_raw), cex.axis=.7, gap=3, ylab=c("Histogram of missing data","Pattern"))
aggr_plot_1 <- aggr(gm_nona, col=c('navyblue','red'), numbers=TRUE, sortVars=TRUE, labels=names(gm_raw), cex.axis=.7, gap=3, ylab=c("Histogram of missing data","Pattern"))
#There are some NA values in income.
tempdata <- mice(data,m=5,maxit=50,meth='pmm',seed=500)
aggr_plot_1 <- aggr(gm_nona, col=c('navyblue','red'), numbers=TRUE, sortVars=TRUE, labels=names(gm_raw), cex.axis=.7, gap=3, ylab=c("Histogram of missing data","Pattern"))
#There are some NA values in income.
income_na <- gm_nona[is.na(gm_nona$income),]
table(income_na)
summary(income_na)
table(income_na$Country~income_na$region)
xtab(income_na$Country~income_na$region)
??xtab
xtabs(income_na$Country~income_na$region)
table(income_na$Country~income_na$region)
table(count(income_na$Country)~income_na$region)
table(income_na$Country,income_na$region)
income_na <- income_na[income_na$income!=0,]
summary(income_na)
table(income_na$Country,income_na$region)
#There are some NA values in income.
income_na <- gm_nona[is.na(gm_nona$income),]
View(income_na)
summary(income_na)
library(dplyr)
income_na%>%group_by(region)
income_na%>%group_by(region)%>%summarise(x=count(unique(Country)))
income_na%>%group_by(region)%>%summarise(x=count(unique(region)))
income_na%>%group_by(region)
income_na%>%group_by(region)%>%count(Country)
income_na%>%group_by(region)%>%count(Country)%>%count(region)
income_na%>%group_by(region)%>%count(Country)%>%count(region)%>%sum(n)
income_na%>%group_by(region)%>%count(Country)%>%count(region)
income_na%>%group_by(region)%>%count(Country)%>%count(region)[n]
regionwise_na <- income_na%>%group_by(region)%>%count(Country)%>%count(region)
regionwise_na
sum(regionwise_na$n)
gm_nona %>% group_by(region) %>%count(is.na(income))
regionwise_na
gm_nona %>% group_by(region) %>%count(is.na(income))
gm_nona %>% group_by(region) %>% unique(Country)
gm_nona %>% group_by(region)
gm_nona %>% group_by(region) %>% unique(Country)
gm_nona %>% group_by(region) %>% count(Country)
gm_nona %>% group_by(region) %>% count(Country) > count(region)
gm_nona %>% group_by(region) %>% count(Country) %>% count(region)
regionwise_nona <- gm_nona %>% group_by(region) %>% count(Country) %>% count(region)
?union
regionwise_na
regionwise_nona
regionwise_na
regionwise_nona
left_join(regionwise_nona,regionwise_na)
regionwise_na$miss <- regionwise_na$n
regionwise_na$miss <- regionwise_na$n
regionwise_na$n <- NULL
left_join(regionwise_nona,regionwise_na)
regionwise_nona$total <- regionwise_nona$n
regionwise_nona$n <- NULL
left_join(regionwise_nona,regionwise_na)
replace_na(left_join(regionwise_nona,regionwise_na),miss,0)
library(tidyverse)
left_join(regionwise_nona,regionwise_na)
left_join(regionwise_nona,regionwise_na)$miss
replace_na(left_join(regionwise_nona,regionwise_na)$miss,0)
replace_na(left_join(regionwise_nona,regionwise_na),0)
left_join(regionwise_nona,regionwise_na)%>%mutate(replace_na(left_join(regionwise_nona,regionwise_na)$miss,0))
left_join(regionwise_nona,regionwise_na)%>%mutate(replace_na(0))
left_join(regionwise_nona,regionwise_na)%>%mutate(miss =replace_na(left_join(regionwise_nona,regionwise_na)$miss,0))
regionwise_nona <- gm_nona %>% group_by(region) %>% count(region)
gm_nona %>% group_by(region) %>% count(region)
left_join(regionwise_nona,regionwise_na)%>%mutate(miss =replace_na(left_join(regionwise_nona,regionwise_na)$miss,0))
regionwise_summary <- left_join(regionwise_nona,regionwise_na)
regionwise_summary %>% mutate(miss = replace_na(miss,0))
regionwise_summary <- regionwise_summary %>% mutate(miss = replace_na(miss,0))
regionwise_summary
regionwise_nona$total <- regionwise_nona$n
regionwise_nona$n <- NULL
regionwise_summary <- left_join(regionwise_nona,regionwise_na)
regionwise_summary <- regionwise_summary %>% mutate(miss = replace_na(miss,0))
regionwise_summary
table(income_na$Country,income_na$region)
regionwise_na <- income_na%>%group_by(region)%>%count(Country)%>%count(region)
regionwise_na$miss <- regionwise_na$n
regionwise_na$n <- NULL
regionwise_nona <- gm_nona %>% group_by(region) %>% count(Country) %>% count(region)
regionwise_nona$total <- regionwise_nona$n
regionwise_nona$n <- NULL
regionwise_summary <- left_join(regionwise_nona,regionwise_na)
regionwise_summary <- regionwise_summary %>% mutate(miss = replace_na(miss,0))
regionwise_summary
regionwise_summary <- regionwise_summary %>% mutate(miss = replace_na(miss,0)) %>% mutate(perc_missing = miss*100/total)
regionwise_summary
regionwise_summary <- regionwise_summary %>% mutate(miss = replace_na(miss,0)) %>% mutate(perc_missing = round(miss*100/total),2))
regionwise_summary <- regionwise_summary %>% mutate(miss = replace_na(miss,0)) %>% mutate(perc_missing = round(miss*100/total),2)
regionwise_summary
regionwise_summary <- regionwise_summary %>% mutate(miss = replace_na(miss,0)) %>% mutate(perc_missing = round((miss*100/total),2))
regionwise_summary
?round
regionwise_summary <- regionwise_summary %>% mutate(miss = replace_na(miss,0)) %>% mutate(perc_missing = (miss*100/total)) %>% mutate(perc_missing = round(perc_missing, digits = 2))
regionwise_summary
regionwise_summary <- regionwise_summary %>% mutate(miss = replace_na(miss,0)) %>% mutate(perc_missing = (miss*100/total))
regionwise_summary
regionwise_summary <- regionwise_summary %>% mutate(miss = replace_na(miss,0))
regionwise_summary
regionwise_summary <- left_join(regionwise_nona,regionwise_na)
regionwise_summary
regionwise_summary <- regionwise_summary %>% mutate(miss = replace_na(miss,0))
regionwise_summary
regionwise_summary <- regionwise_summary %>% mutate(miss = replace_na(miss,0)) %>% mutate(perc = (miss*100/total))
regionwise_summary
regionwise_summary %>% mutate(miss = replace_na(miss,0)) %>% mutate(perc = (miss*100/total)) %>% mutate(perc_missing = round(perc_missing, digits = 2))
regionwise_summary %>% mutate(miss = replace_na(miss,0)) %>% mutate(perc = (miss*100/total)) %>% mutate(perc = round(perc, digits = 2))
regionwise_summary <- regionwise_summary %>% mutate(miss = replace_na(miss,0)) %>% mutate(perc_na = (miss*100/total)) %>% mutate(perc = round(perc_na, digits = 2))
regionwise_summary
regionwise_summary <- regionwise_summary %>% mutate(miss = replace_na(miss,0)) %>% mutate(percentage_na = (miss*100/total)) %>% mutate(percentage_na = round(percentage_na, digits = 2))
regionwise_summary
regionwise_summary <- left_join(regionwise_nona,regionwise_na)
regionwise_summary <- regionwise_summary %>% mutate(miss = replace_na(miss,0)) %>% mutate(percentage_na = (miss*100/total)) %>% mutate(percentage_na = round(percentage_na, digits = 2))
regionwise_summary
gm_nona %>% group_by(region) %>% count(Country)
country_research <- gm_nona %>% group_by(region) %>% count(Country)
country_research
country_research$region <- NULL
country_research
country_all <- gm_nona %>% group_by(region) %>% count(Country)
country_all$region <- NULL
country_all
country_na <- income_na%>%group_by(region)%>%count(Country)
country_na$region < NULL
country_na
country_na <- income_na%>%group_by(region)%>%count(Country)
country_na$region <- NULL
country_na
country_na$miss <- country_na$n
left_join(country_all, country_na)
country_summary <- left_join(country_all, country_na)
country_summary
country_summary[!(is.na(country_summary$miss))]
country_summary[!(is.na(country_summary$miss)),]
country_summary <- country_summary[!(is.na(country_summary$miss)),]
country_summary
knitr::opts_chunk$set(echo = TRUE)
mean(gm_nona,na.rm = TRUE)
mean(gm_nona$income,na.rm = TRUE)
gm_nona %>% group_by(region,Year) %>% mean(income)
library(tidyverse)
gm_nona %>% group_by(region,Year) %>% mean(income)
gm_nona %>% group_by(region,Year) %>% mean(income,na.rm = TRUE)
gm_nona %>% group_by(region,Year)
str(gm_nona)
mean(gm_nona$income)
mean(gm_nona$income,na.rm = TRUE)
gm_nona %>% group_by(region,Year)
gm_nona %>% group_by(region,Year) %>% mean(income,na.rm = TRUE)
gm_nona %>% group_by(region) %>% mean(income,na.rm = TRUE)
gm_nona %>% group_by(region) %>% summarise(avg_income = mean(income, na.rm = TRUE))
gm_nona %>% group_by(region,Year) %>% summarise(avg_income = mean(income, na.rm = TRUE))
yearwise_regional_income <- gm_nona %>% group_by(region,Year) %>% summarise(avg_income = mean(income, na.rm = TRUE))
gm_nona %>% group_by(region,Year) %>% summarise(avg_income = mean(income, na.rm = TRUE))
yearwise_regional_income[region=="South Asia"]
yearwise_regional_income[region=="South Asia",]
yearwise_regional_income[yearwise_regional_income$region=="South Asia",]
?and
??and
yearwise_regional_income[yearwise_regional_income$region=="South Asia" & yearwise_regional_income$Year==1800,]
yearwise_regional_income[yearwise_regional_income$region=="South Asia" & yearwise_regional_income$Year==1800,"avg_income"]
yearwise_regional_income[yearwise_regional_income$region=="South Asia" & yearwise_regional_income$Year==1800,3]
yearwise_regional_income[yearwise_regional_income$region=="South Asia" & yearwise_regional_income$Year==1800,]
?for
knitr::opts_chunk$set(echo = TRUE)
regionwise_summary
country_summary
14*100/197
View(gm_raw)
str(gm_raw)
summary(gm_raw)
sum(is.na(gm_raw$income))
## Data Description
We have `r nrow(gm_raw)` observations and `r ncol(gm_raw)` variables. The missing population values were filled with the population count at the start of the decade. We have `r sum(is.na(gm_raw$income))` NA values in the income variable over. Since the countries with the NA income values do not have any income
nrow(gm_raw)
ncol(gm_raw)
ncol(gm_raw)
sum(is.na(gm_raw$income))
nrow(country_summary)
country_summary$country
country_summary$Country
names(gm_raw)
typeof(gm_raw$Country)
summary(gm_raw$Country)
summary(gm_raw$Country)
summary(gm_raw)
str(gm_raw)
typeof(gm_raw$Country)
typeof(gm_nona$Country)
yearwise_regional_income[yearwise_regional_income$region=="South Asia" & yearwise_regional_income$Year==1800,]
max(gm_raw$Year)
gm_raw <- read_csv("C:/Users/scyth/OneDrive/Documents/HarrisburgU/AN_506_OS/EDA/FinalProject/Data/gapminder.csv", col_types = "fnniif")
setwd("C:/Users/scyth/OneDrive/Documents/HarrisburgU/AN_506_OS/EDA/FinalProject/R_Code")
library(tidyverse)
library(mice)
library(VIM)
gm_raw <- read_csv("C:/Users/scyth/OneDrive/Documents/HarrisburgU/AN_506_OS/EDA/FinalProject/Data/gapminder.csv", col_types = "fnniif")
max(gm_raw$Year)
max(gm_raw$Year)-min(gm_raw$Year)
min(gm_raw$Year)
max(gm_raw$Year)-min(gm_raw$Year)
names(gm_raw)
gm_raw$Country
unique(gm_raw$Country)
count(unique(gm_raw$Country))
levels(gm_raw$Country)
count(levels(gm_raw$Country))
View(country_all)
nrow(country_all)
View(regionwise_na)
View(regionwise_summary)
nrow(regionwise_summary)
nrow(regionwise_summary)
range(gm_nona[gm_nona$Year==2015]$population)
range(gm_nona[gm_nona$Year==2015]$population)
gm_nona[gm_nona$Year==2015]
gm_nona$Year==2015
gm_nona[gm_nona$Year==2015]
range(gm_nona[gm_nona$Year==2015,2])
gm_nona[gm_nona$Year==2015,2]
gm_nona[gm_nona$Year==2015,3]
gm_nona[gm_nona$Year==2015,4]
range(gm_nona[gm_nona$Year==2015,4])
range(gm_raw$Year)
range(gm_nona[gm_nona$Year==2015,4])
max(gm_nona[gm_nona$Year==2015,4)
max(gm_nona[gm_nona$Year==2015,4])
gm_nona[gm_nona$population==max(gm_nona[gm_nona$Year==2015,4]),1]
unique(gm_nona[gm_nona$population==max(gm_nona[gm_nona$Year==2015,4]),1])
gm_nona[gm_nona$Year==2015,4])
max(gm_nona[gm_nona$Year==2015,4])
gm_nona[gm_nona$population==1311050527,1]
View(gm_nona)
max(gm_raw[gm_raw$Year==2015,4])
max(gm_raw[gm_raw$Year==2015,4],na.rm = TRUE)
