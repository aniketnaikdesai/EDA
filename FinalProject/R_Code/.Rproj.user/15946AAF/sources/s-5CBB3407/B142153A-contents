---
title: "Final_Project"
author: "Aniket Naik Desai"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## Questions for EDA
1. At the same income level, does increase in average life expectancy vary based on region?
2. Has average life expectancy increased in all regions at the same rate over the years?
3. At what income level does the increase in life expectancy stop increasing for the various regions?


```{r Initital_Loading, echo=FALSE, message=FALSE, warning=FALSE}
setwd("C:/Users/scyth/OneDrive/Documents/HarrisburgU/AN_506_OS/EDA/FinalProject/R_Code")

library(tidyverse)
library(mice)
library(VIM)


gm_raw <- read_csv("C:/Users/scyth/OneDrive/Documents/HarrisburgU/AN_506_OS/EDA/FinalProject/Data/gapminder.csv", col_types = "ffniif")
```


```{r Data_Screening, echo=FALSE, message=FALSE, warning=FALSE}
#Filling NA's
gm_nona <- gm_raw
gm_nona <- gm_raw %>% fill(population)

#beflore fixing missing population
aggr_plot <- aggr(gm_raw, col=c('navyblue','red'), numbers=TRUE, sortVars=TRUE, labels=names(gm_raw), cex.axis=.7, gap=3, ylab=c("Histogram of missing data","Pattern"))

#after fixing the missing population
aggr_plot_1 <- aggr(gm_nona, col=c('navyblue','red'), numbers=TRUE, sortVars=TRUE, labels=names(gm_raw), cex.axis=.7, gap=3, ylab=c("Histogram of missing data","Pattern"))

#There are some NA values in income.
income_na <- gm_nona[is.na(gm_nona$income),]
summary(income_na)

#How many countries are missing income values per region
table(income_na$Country,income_na$region)  
regionwise_na <- income_na%>%group_by(region)%>%count(Country)%>%count(region)
regionwise_na$miss <- regionwise_na$n
regionwise_na$n <- NULL

regionwise_nona <- gm_nona %>% group_by(region) %>% count(Country) %>% count(region)
regionwise_nona$total <- regionwise_nona$n
regionwise_nona$n <- NULL

regionwise_summary <- left_join(regionwise_nona,regionwise_na)
regionwise_summary <- regionwise_summary %>% mutate(miss = replace_na(miss,0)) %>% mutate(percentage_na = (miss*100/total)) %>% mutate(percentage_na = round(percentage_na, digits = 2))

regionwise_summary

country_all <- gm_nona %>% group_by(region) %>% count(Country)
country_all$region <- NULL
country_all

country_na <- income_na%>%group_by(region)%>%count(Country)
country_na$region <- NULL
country_na$miss <- country_na$n


country_summary <- left_join(country_all, country_na)
country_summary <- country_summary[!(is.na(country_summary$miss)),]
country_summary

```

Countries which have NA Values income variable don't have any non-NA income values. We cannot use mice to impute the missing values. We might need to either ignore/delete the affected rows or use mean replacement based on mean of the region for the year.

```{r Compute average yearwise regional income, echo=FALSE, message=FALSE, warning=FALSE}
mean(na.rm = TRUE)

yearwise_regional_income <- gm_nona %>% group_by(region,Year) %>% summarise(avg_income = mean(income, na.rm = TRUE))

yearwise_regional_income[yearwise_regional_income$region=="South Asia" & yearwise_regional_income$Year==1800,]
  
```



