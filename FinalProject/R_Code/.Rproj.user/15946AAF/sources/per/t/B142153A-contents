---
title: "Final_Project"
author: "Aniket Naik Desai"
date: "`r Sys.Date()`"
output:
  word_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## Questions for Exploratory Data Analysis of gapminder dataset
1. At the same income level, does increase in average life expectancy vary based on region?
2. Has average life expectancy increased in all regions at the same rate over the years?
3. At what income level does the increase in life expectancy stop increasing for the various regions?


```{r Initital_Loading, echo=FALSE, message=FALSE, warning=FALSE}
setwd("C:/Users/scyth/OneDrive/Documents/HarrisburgU/AN_506_OS/EDA/FinalProject/R_Code")

library(tidyverse)
library(mice)
library(VIM)


gm_raw <- read_csv("C:/Users/scyth/OneDrive/Documents/HarrisburgU/AN_506_OS/EDA/FinalProject/Data/gapminder.csv", col_types = "fnniif")


```

```{r Data_Screening, echo=FALSE, message=FALSE, warning=FALSE}
#Filling NA's
gm_nona <- gm_raw
gm_nona <- gm_raw %>% fill(population)

#beflore fixing missing population
aggr_plot <- aggr(gm_raw, col=c('navyblue','red'), numbers=TRUE, sortVars=TRUE, labels=names(gm_raw), cex.axis=.7, gap=3, ylab=c("Histogram of missing data","Pattern"))

#after fixing the missing population
aggr_plot_1 <- aggr(gm_nona, col=c('navyblue','red'), numbers=TRUE, sortVars=TRUE, labels=names(gm_raw), cex.axis=.7, gap=3, ylab=c("Histogram of missing data","Pattern"))

#There are some NA values in income.
income_na <- gm_nona[is.na(gm_nona$income),]
summary(income_na)

#How many countries are missing income values per region
table(income_na$Country,income_na$region)  
regionwise_na <- income_na%>%group_by(region)%>%count(Country)%>%count(region)
regionwise_na$miss <- regionwise_na$n
regionwise_na$n <- NULL

regionwise_nona <- gm_nona %>% group_by(region) %>% count(Country) %>% count(region)
regionwise_nona$total <- regionwise_nona$n
regionwise_nona$n <- NULL

regionwise_summary <- left_join(regionwise_nona,regionwise_na)
regionwise_summary <- regionwise_summary %>% mutate(miss = replace_na(miss,0)) %>% mutate(percentage_na = (miss*100/total)) %>% mutate(percentage_na = round(percentage_na, digits = 2))

regionwise_summary

country_all <- gm_nona %>% group_by(region) %>% count(Country)
country_all$region <- NULL
country_all

country_na <- income_na%>%group_by(region)%>%count(Country)
country_na$region <- NULL
country_na$miss <- country_na$n


country_summary <- left_join(country_all, country_na)
country_summary <- country_summary[!(is.na(country_summary$miss)),]
country_summary

```

Countries which have NA Values income variable don't have any non-NA income values. We cannot use mice to impute the missing values. We might need to either ignore/delete the affected rows or use mean replacement based on mean of the region for the year.

```{r Compute average yearwise regional income, echo=FALSE, message=FALSE, warning=FALSE}


yearwise_regional_income <- gm_nona %>% group_by(region,Year) %>% summarise(avg_income = mean(income, na.rm = TRUE))

yearwise_regional_income[yearwise_regional_income$region=="South Asia" & yearwise_regional_income$Year==1800,]
```


# Data Description
We have `r nrow(gm_raw)` observations and `r ncol(gm_raw)` variables. Two variables are categorical and four variables are continous.

## Type of Data Variables
Country and region are categorical variables with 197 levels and 6 levels respectively. Year, Population, Life, and income are numeric variables. Life variable is the life expectancy of the population while income is calculated as gdp per capita.

## Missing Values
The missing population values were filled with the population count at the start of the decade. We have `r sum(is.na(gm_raw$income))` NA values in the income variable spread over `r nrow(country_summary)` countries. These countries do not have any income values recorded in the dataset hence we are not able to compute any values to replace the NA values. Due to this in any calculation involving income we will ignore the following countries `r country_summary$Country`.

## Data Dispersion
We have data about `r nrow(country_all)` countries over `r nrow(regionwise_summary)` regions. Our data has been gathered over `r max(gm_raw$Year)-min(gm_raw$Year)` years starting from `r max(gm_raw$Year)`  up till ` r min(gm_raw$Year)`. The population of all countries changed over time with xyz country from region having the highest population in 2015 and country from region having the lowest population.
unique(gm_nona[gm_nona$population==max(gm_nona[gm_nona$Year==2015,4]),1])

